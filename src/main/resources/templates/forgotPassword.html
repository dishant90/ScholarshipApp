<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">

<head>
	<title>Student Scholarship Application</title>
	<link rel="stylesheet" type="text/css" th:href="@{/css/login.css}" />
  	<link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap.min.css}" />
</head>

<body>
	<form th:action="@{/registration}" method="get">
		<button class="btn btn-md btn-warning btn-block" type="Submit">Go To Registration Page</button>
	</form>
	<form th:action="@{/}" method="get">
		<button class="btn btn-md btn-warning btn-block" type="Submit">Go To Login Page</button>
	</form>
	
	<div class="container">
		<h1 th:text="#{forgotPassword.resetPassword.label}">Reset</h1>
    	<br/>
	    <div class="row">
	      <form id="resetPasswordForm" action="#">
	        <label class="col-sm-1" th:text="#{forgotPassword.emailID.label}">email</label>
	        <span class="col-sm-5"><input class="form-control" id="email" name="email" type="email" value="" required="required" /></span>
	        <button class="btn btn-primary" type="submit" th:text="#{forgotPassword.reset.button}">reset</button>
	      </form>
	    </div>
	    <script src="../js/jquery-3.1.1.min.js" th:src="@{/js/jquery-3.1.1.min.js}"></script>
  		<script src="https://npmcdn.com/tether@1.2.4/dist/js/tether.min.js"></script>
  		<script src="../js/bootstrap-4.0.0.min.js" th:src="@{/js/bootstrap-4.0.0.min.js}"></script>
	    <script th:inline="javascript">
			/*<![CDATA[*/           
			var serverContext = [[@{/}]];
			
			$(document).ready(function () {
				$('#resetPasswordForm').submit(function(event) {
					resetPass(event);
			    });
			});
			
			function resetPass(event){
			    event.preventDefault();	
			    var email = $("#email").val();
			    $.post(serverContext + "user/resetPassword",{email: email} ,function(data){
			            window.location.href = serverContext + "login?message=" + data.message;
			    })
			    .fail(function(data) {
			    	if(data.responseJSON.error.indexOf("MailError") > -1)
			        {
			            window.location.href = serverContext + "emailError.html";
			        }
			        else{
			            window.location.href = serverContext + "login?message=" + data.responseJSON.message;
			        }
			    });
			}
			
			/*]]>*/
		</script>
	</div>
</body>
</html>